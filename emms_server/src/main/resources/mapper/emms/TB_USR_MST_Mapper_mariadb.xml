<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.emms.mapper.TB_USR_MST_Mapper">
	
	<!-- 로그인, 아이디 패스워드로 조회 -->
	<select id="TB_USR_MST_PS001" resultType="TB_USR_MST_VO" >
		SELECT  USR_NUM
		       ,USR_NAME
		       ,USR_BIR_MD
		       ,USR_EMAIL
		       ,USR_TEL_NUM
		       ,USR_ADR
		       ,INC_CD
		       ,APO_CD
		       ,EDU_CD
		       ,TIM_NUM
		       ,LOGIN_ID
		       ,PASS_NUM
		       ,JOIN_YN
		       ,DEL_YN
		       ,RMK
		       ,CRT_DTM
		       ,CRT_USR_NUM
		       ,MDF_DTM
		       ,MDF_USR_NUM
		  FROM TB_USR_MST
		 WHERE LOGIN_ID = #{loginId}
		   AND PASS_NUM = #{passNum} 
		 LIMIT 0,1
 	</select>	
 	
 	<select id="TB_USR_MST_VL001" parameterType="String" resultType="TB_USR_MST_VO">
 		SELECT  A.USR_NUM
 			   ,A.LOGIN_ID
 			   ,A.USR_NAME
 			   ,A.USR_BIR_MD
 			   ,B.CD_NM AS INC_CD
 			   ,C.AUTH_NM AS APO_CD
 			   ,A.USR_EMAIL
 			   ,A.USR_TEL_NUM
 			   ,D.TIM_NM AS TIM_NUM
 			   ,A.JOIN_YN
 		FROM TB_USR_MST AS A
 		LEFT OUTER JOIN tb_cd_lst AS B
 			   ON A.INC_CD = B.CD_VAL
 		LEFT OUTER JOIN TB_AUTH_MST AS C
 			   ON LEFT(A.APO_CD,'3') = LEFT(C.AUTH_NUM,'3')
 		LEFT OUTER JOIN TB_TIM_MST AS D
 			   ON A.TIM_NUM = D.TIM_NUM
 		ORDER BY A.USR_NUM DESC
 	</select>
 	
 	<update id="TB_USR_MST_PU001" parameterType="Map">
 		UPDATE tb_usr_mst SET ${column} = #{value} WHERE USR_NUM = #{id};
 	</update>
 	
 	<update id="TB_USR_MST_PU002" parameterType="Map">
 		UPDATE tb_usr_mst SET PASS_NUM = #{usrBirMd} WHERE USR_NUM = #{usrNum};
 	</update>
 	
	
</mapper>